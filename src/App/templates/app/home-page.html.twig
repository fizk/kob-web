{% extends '@layout/default.html.twig' %}

{% block title %}Kling&amp;Bang{% endblock %}

{% block meta %}
    <link rel="canonical" href="{{ host }}{{ path(language == 'is' ? 'heim' : 'home') }}" />
    <meta property="og:url"         content="{{ host }}{{ path(language == 'is' ? 'heim' : 'home') }}" />
    <meta property="og:type"        content="article" />
    <meta property="og:title"       content="Kling&amp;Bang" />
{% endblock %}

{% block content %}
    <main>
        {% for item in list %}
            <article class="entry">
                <aside class="entry__aside">
                    {% if item.poster %}
                    <img class="entry__poster" src="{{ path('asset', {size: 'x', name: item.poster.name}) }}" />
                    {% endif %}
                </aside>
                <div class="entry__body">
                    {% if loop.first %}
                        {% include '@partials/header.html.twig' %}
                    {% endif %}
                    {% if user_session %}
                        <a class="entry__edit-button" href="{{ path('update-entry', {id: item.id}) }}">edit</a>
                    {% endif %}
                    <ul class="entry__primary-caption">
                        {% if item.type == 'show' %}
                            {% for author in item.authors %}
                                <li class="entry__primary-caption-item">
                                    <h2 class="entry__primary-caption-text">
                                        <a class="entry__link" href="{{ path(language == 'is' ? 'syning' : 'entry', {id: item.title|slug(item.id)}) }}">{{ author.name }}</a>
                                    </h2>
                                </li>
                            {% endfor %}
                        {% else %}
                            <li class="entry__primary-caption-item">
                                <h2 class="entry__primary-caption-text">
                                    <a class="entry__link" href="{{ path(language == 'is' ? 'syning' : 'entry', {id: item.title|slug(item.id)}) }}">{{ item.title }}</a>
                                </h2>
                            </li>
                        {% endif %}
                    </ul>

                    {% if item.type == 'show' or item.type == 'proj' %}
                        <time class="entry__time">{{ item.from|date }} - {{ item.to|date }}</time>
                    {% endif %}

                    {% if item.type == 'show' %}
                        <h3 class="entry__secondary-caption-text">
                            <a class="entry__link" href="{{ path(language == 'is' ? 'syning' : 'entry', {id: item.title|slug(item.id)}) }}">{{ item.title }}</a>
                        </h3>
                    {% endif %}

                    {% if item.type != 'show' %}
                        <div class="entry__text markdown-text">
                        {% markdown %}
                            {{ item.body|length > 300 ? item.body|slice(0, 300) ~ '...' : item.body|raw  }}
                        {% endmarkdown %}
                        </div>
                    {% endif %}
                </div>
            </article>
        {% endfor %}

        {% for item in upcoming %}
            <article>
                <aside>
                    {% if item.poster %}
                        <img src="{{ path('asset', {size: '300x', name: item.poster.name}) }}" />
                    {% endif %}
                </aside>
                <div>
                    <ul>
                    {% for author in item.authors %}
                        <li>
                            <h2>
                                <a href="{{ path(language == 'is' ? 'syning' : 'entry', {id: item.title|slug(item.id)}) }}">{{ author.name }}</a>
                            </h2>
                        </li>
                    {% endfor %}
                    </ul>
                    <time>{{ item.from|date }} - {{ item.to|date }}</time>
                    <h3>
                        <a href="{{ path(language == 'is' ? 'syning' : 'entry', {id: item.title|slug(item.id)}) }}">{{ item.title }}</a>
                    </h3>
                </div>
            </article>
        {% endfor %}
    </main>
{% endblock %}
